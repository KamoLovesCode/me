(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{6330:function(e,t,s){Promise.resolve().then(s.bind(s,2622))},2622:function(e,t,s){"use strict";s.d(t,{default:function(){return I}});var a=s(5434),r=s(3936),l=s(1733),i=s(2297),n=s(8483),o=s(5826),c=s(2629),d=s(5844),m=s(7355),h=s(640),x=s(8389),u=s(6370),g=s(5595),p=s(2533);let f=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,p.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});f.displayName="Input";var b=s(5258),v=s(8935);let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(v.fC,{ref:t,className:(0,p.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r})});y.displayName=v.fC.displayName;let j=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(v.Ee,{ref:t,className:(0,p.cn)("aspect-square h-full w-full",s),...r})});j.displayName=v.Ee.displayName;let N=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(v.NY,{ref:t,className:(0,p.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r})});N.displayName=v.NY.displayName;var w=s(116),S=s(9008),k=s(8129),C=s(4857),z=s(2644);function A(e){let{onTranscript:t}=e,[s,l]=(0,r.useState)(!1),[i,n]=(0,r.useState)(!1),[o,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(0),[h,x]=(0,r.useState)(!0);(0,r.useRef)(null);let u=(0,r.useRef)(null),g=(0,r.useRef)(null),p=(0,r.useRef)(null),f=(0,r.useRef)(null),b=(0,r.useRef)(null),{toast:v}=(0,z.pm)();(0,r.useEffect)(()=>()=>{f.current&&cancelAnimationFrame(f.current),p.current&&speechSynthesis.cancel(),b.current&&b.current.stop()},[]);let y=()=>{if(!g.current)return;let e=new Uint8Array(g.current.frequencyBinCount);g.current.getByteFrequencyData(e),m(e.reduce((e,t)=>e+t)/e.length/255),s&&(f.current=requestAnimationFrame(y))},j=async()=>{try{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)throw Error("Speech recognition not supported");let a=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});u.current=new AudioContext,g.current=u.current.createAnalyser(),u.current.createMediaStreamSource(a).connect(g.current),g.current.fftSize=256,b.current=new e,b.current.continuous=!1,b.current.interimResults=!1,b.current.lang="en-US",b.current.onresult=async e=>{let s=e.results[0][0].transcript;null==t||t(s),await w(s),N()},b.current.onerror=e=>{console.error("Speech recognition error:",e.error),N(),v({title:"Voice Input Error",description:"Could not process your voice. Please try again.",variant:"destructive"})},b.current.onend=()=>{N()},l(!0),b.current.start(),y(),setTimeout(()=>{s&&N()},1e4)}catch(e){v({title:"Microphone Error",description:"Could not access microphone. Please check permissions.",variant:"destructive"})}},N=()=>{b.current&&b.current.stop(),l(!1),m(0),f.current&&cancelAnimationFrame(f.current)},w=async e=>{n(!0);try{let t=await fetch("/api/gemini-voice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});if(t.ok){let e=await t.json();A(e.response)}else throw Error("Failed to get response from Gemini")}catch(e){v({title:"AI Error",description:"Failed to get AI response. Please try again.",variant:"destructive"})}finally{n(!1)}},A=e=>{c(!0),p.current=new SpeechSynthesisUtterance(e),p.current.rate=.9,p.current.pitch=1,p.current.volume=1;let t=speechSynthesis.getVoices().find(e=>e.name.includes("Google")||e.name.includes("Microsoft")||e.lang.startsWith("en")&&e.name.includes("Neural"));t&&(p.current.voice=t),p.current.onend=()=>{c(!1)},speechSynthesis.speak(p.current)};return(0,a.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:h?(0,a.jsx)("button",{onClick:()=>x(!1),className:"w-16 h-16 rounded-full flex items-center justify-center transition-all duration-300 shadow-lg ".concat(s?"bg-red-500 animate-pulse":i?"bg-yellow-500":o?"bg-green-500":"bg-purple-600 hover:bg-purple-700"),style:{transform:"scale(".concat(1+.2*d,")"),boxShadow:s?"0 0 ".concat(20+30*d,"px rgba(239, 68, 68, 0.5)"):"0 4px 20px rgba(0,0,0,0.3)"},children:s?(0,a.jsx)(S.Z,{size:24,className:"text-white"}):i?(0,a.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-white border-t-transparent rounded-full"}):o?(0,a.jsx)(k.Z,{size:24,className:"text-white"}):(0,a.jsx)(S.Z,{size:24,className:"text-white"})}):(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-xl p-4 w-64 border border-border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm",children:"Voice Assistant"}),(0,a.jsx)("button",{onClick:()=>x(!0),className:"text-muted-foreground hover:text-foreground",children:(0,a.jsx)(C.Z,{size:16})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center transition-all ".concat(s?"bg-red-500":i?"bg-yellow-500":o?"bg-green-500":"bg-purple-600"),style:{transform:"scale(".concat(1+.2*d,")")},children:s?(0,a.jsx)(S.Z,{size:20,className:"text-white"}):i?(0,a.jsx)("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}):o?(0,a.jsx)(k.Z,{size:20,className:"text-white"}):(0,a.jsx)(S.Z,{size:20,className:"text-white"})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:s?"Listening...":i?"Processing...":o?"Speaking...":"Ready"})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[!s&&!i&&!o&&(0,a.jsx)("button",{onClick:j,className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 px-3 rounded text-xs font-medium transition",children:"Start Listening"}),s&&(0,a.jsx)("button",{onClick:N,className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-2 px-3 rounded text-xs font-medium transition",children:"Stop"}),o&&(0,a.jsx)("button",{onClick:()=>{p.current&&(speechSynthesis.cancel(),c(!1))},className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-3 rounded text-xs font-medium transition",children:"Interrupt"})]})]})})}var D=s(2483);let U=null;try{U=s(8838).Z}catch(e){console.warn("Peer chat system not available:",e)}function I(){var e;let[t,s]=(0,r.useState)(!1),[p,v]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1),[C,z]=(0,r.useState)(!0),[I,T]=(0,r.useState)(""),[E,M]=(0,r.useState)({name:"",email:"",phone:"",company:""}),[O,R]=(0,r.useState)([]),[P,Z]=(0,r.useState)([]),[_,q]=(0,r.useState)(""),[L,F]=(0,r.useState)([]),[G,H]=(0,r.useState)(""),[B,J]=(0,r.useState)("all"),[V,Y]=(0,r.useState)(""),K=(0,r.useRef)(null),W=(0,r.useRef)(null),[$,X]=(0,r.useState)(""),[Q,ee]=(0,r.useState)([]),[et,es]=(0,r.useState)([]),[ea,er]=(0,r.useState)([]),[el,ei]=(0,r.useState)(!1),[en,eo]=(0,r.useState)(null),[ec,ed]=(0,r.useState)(""),[em,eh]=(0,r.useState)(!1),[ex,eu]=(0,r.useState)(""),[eg,ep]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=localStorage.getItem("chat-phonebook");if(e)try{ep(JSON.parse(e))}catch(e){}},[]);let ef=e=>/^[a-zA-Z\s\-']{2,50}$/.test(e.trim()),eb=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim()),ev=e=>/^[\+]?[0-9\s\-\(\)]{10,15}$/.test(e.trim()),ey=()=>{let e=[];return ef(E.name)||e.push("Name must be 2-50 characters and contain only letters, spaces, hyphens, or apostrophes"),eb(E.email)||e.push("Please enter a valid email address"),ev(E.phone)||e.push("Please enter a valid phone number"),E.company.trim().length<2&&e.push("Company/Organization name is required"),eg.some(e=>e.email.toLowerCase()===E.email.toLowerCase())&&e.push("This email is already registered"),R(e),0===e.length},ej=()=>{let e=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-cyan-500","bg-lime-500","bg-rose-500"];return e[Math.floor(Math.random()*e.length)]};(0,r.useEffect)(()=>{localStorage.removeItem("chat-username"),localStorage.removeItem("user-color"),z(!0)},[]),(0,r.useEffect)(()=>()=>{W.current&&(W.current.leave(),W.current=null)},[G]),(0,r.useEffect)(()=>{var e;null===(e=K.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[P]);let eN=()=>{if(_.trim()){if(W.current)try{W.current.sendMessage(B,_)?q(""):console.log("Message requires permission or failed to send")}catch(t){console.error("Error sending message:",t);let e={id:Date.now(),text:"[Local] ".concat(_),from:G,to:B,time:Date.now()};Z(t=>[...t,e]),q("")}else{let e={id:Date.now(),text:"[Local] ".concat(_),from:G,to:B,time:Date.now()};Z(t=>[...t,e]),q("")}}},[ew,eS]=(0,r.useState)(!1),ek=async()=>{if(_.trim()){eS(!0);try{var e,t,s,a,r,l;let i=D.env.NEXT_PUBLIC_GEMINI_API_KEY,n="https://generativelanguage.googleapis.com/v1beta/models/".concat("models/gemini-2.5-flash-preview-native-audio-dialog",":generateContent?key=").concat(i),o=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{role:"user",parts:[{text:_}]}],generationConfig:{responseMimeType:"audio/wav",responseModality:"AUDIO"}})});if(!o.ok)throw Error("Failed to fetch Gemini audio");let c=await o.json(),d=null==c?void 0:null===(l=c.candidates)||void 0===l?void 0:null===(r=l[0])||void 0===r?void 0:null===(a=r.content)||void 0===a?void 0:null===(s=a.parts)||void 0===s?void 0:null===(t=s.find(e=>e.inlineData))||void 0===t?void 0:null===(e=t.inlineData)||void 0===e?void 0:e.data;if(d){let e=new Blob([Uint8Array.from(atob(d),e=>e.charCodeAt(0))],{type:"audio/wav"}),t=URL.createObjectURL(e);new Audio(t).play()}else alert("No audio reply received.")}catch(e){alert("Error with Gemini audio reply."),console.error(e)}eS(!1)}},eC=e=>{en&&W.current&&(W.current.handlePermissionResponse(en.from,e,en.id),e&&er(e=>[...e,en.from])),ei(!1),eo(null)};return C?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-black p-4",children:(0,a.jsxs)("div",{className:"bg-black rounded-lg shadow-xl p-6 w-full max-w-md border border-gray-800",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-center mb-2 text-white",children:"Join the Chat"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 text-center mb-6",children:"Please provide your information to start chatting. You'll be assigned a unique color."}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block text-white",children:"Full Name *"}),(0,a.jsx)(f,{placeholder:"John Doe",value:E.name,onChange:e=>M(t=>({...t,name:e.target.value})),className:"bg-gray-900 border-gray-700 text-white placeholder:text-gray-500 focus:border-gray-600 ".concat(O.some(e=>e.includes("Name"))?"border-red-500":"")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block text-white",children:"Email Address *"}),(0,a.jsx)(f,{type:"email",placeholder:"john@example.com",value:E.email,onChange:e=>M(t=>({...t,email:e.target.value})),className:"bg-gray-900 border-gray-700 text-white placeholder:text-gray-500 focus:border-gray-600 ".concat(O.some(e=>e.includes("email"))?"border-red-500":"")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block text-white",children:"Phone Number *"}),(0,a.jsx)(f,{placeholder:"+1 (555) 123-4567",value:E.phone,onChange:e=>M(t=>({...t,phone:e.target.value})),className:"bg-gray-900 border-gray-700 text-white placeholder:text-gray-500 focus:border-gray-600 ".concat(O.some(e=>e.includes("phone"))?"border-red-500":"")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block text-white",children:"Company/Organization *"}),(0,a.jsx)(f,{placeholder:"Acme Corp",value:E.company,onChange:e=>M(t=>({...t,company:e.target.value})),className:"bg-gray-900 border-gray-700 text-white placeholder:text-gray-500 focus:border-gray-600 ".concat(O.some(e=>e.includes("Company"))?"border-red-500":"")})]}),O.length>0&&(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-3",children:(0,a.jsx)("ul",{className:"text-sm text-red-400 space-y-1",children:O.map((e,t)=>(0,a.jsxs)("li",{children:["• ",e]},t))})}),(0,a.jsx)(b.z,{onClick:()=>{if(!ey())return;let e=ej(),t={id:Date.now().toString(),name:E.name.trim(),email:E.email.trim().toLowerCase(),phone:E.phone.trim(),company:E.company.trim(),joinedAt:new Date().toISOString(),color:e},s=[...eg,t];if(ep(s),localStorage.setItem("chat-phonebook",JSON.stringify(s)),localStorage.setItem("chat-username",t.name),localStorage.setItem("user-color",e),H(t.name),X(e),z(!1),U)try{W.current=new U,W.current.onNewMessage=e=>{Z(t=>[...t,e])},W.current.onUsersUpdate=e=>{ee(e),F(e.map(e=>e.name))},W.current.onPermissionRequest=(e,t,s)=>{eo({from:e,message:t,id:s||Date.now().toString()}),ei(!0)},W.current.onPermissionGranted=e=>{er(t=>[...t,e])};let s=W.current.join(t.name,e,t.email,t.phone);ee(s),F(s.map(e=>e.name));let a=W.current.getMessages();Z(a),W.current.startHeartbeat()}catch(e){console.error("Failed to initialize chat system:",e),Z([{id:Date.now(),text:"Welcome! Chat functionality is loading...",from:"System",time:Date.now()}])}else console.warn("Chat system not available"),Z([{id:Date.now(),text:"Welcome! You can use this interface, but real-time chat is not available.",from:"System",time:Date.now()}])},className:"w-full bg-white text-black hover:bg-gray-200",disabled:!E.name||!E.email||!E.phone||!E.company,children:"Start Chatting"})]})]})}):(0,a.jsxs)("div",{className:"flex h-screen bg-black chat-page",children:[(0,a.jsxs)("div",{className:"hidden lg:flex lg:flex-col lg:w-80 xl:w-96 bg-black border-r border-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(y,{className:"w-10 h-10",children:(0,a.jsx)(N,{className:"".concat($," text-white font-semibold"),children:G.slice(0,2).toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-white",children:G}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"● Online"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[t&&(0,a.jsx)(b.z,{size:"sm",variant:"ghost",onClick:()=>k(!0),className:"text-white hover:bg-gray-800",children:(0,a.jsx)(l.Z,{size:16})}),(0,a.jsx)(b.z,{size:"sm",variant:"ghost",onClick:()=>v(!0),className:"text-white hover:bg-gray-800",children:(0,a.jsx)(i.Z,{size:16})}),(0,a.jsx)(b.z,{size:"sm",variant:"ghost",onClick:()=>{H(""),s(!1),localStorage.removeItem("chat-username"),localStorage.removeItem("user-color"),window.location.href="/"},className:"text-white hover:bg-gray-800",children:(0,a.jsx)(n.Z,{size:16})})]})]}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Chats"})}),(0,a.jsx)("div",{className:"px-4 pb-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.Z,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,a.jsx)(f,{placeholder:"Search conversations",className:"pl-10 bg-gray-900 border-gray-700 text-white placeholder:text-gray-500"})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center p-3 rounded-xl cursor-pointer mb-2 transition-all duration-200 ".concat("all"===B?"bg-white text-black":"hover:bg-gray-800 text-white"),onClick:()=>J("all"),children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{size:20,className:"text-white"})})}),(0,a.jsxs)("div",{className:"ml-3 flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:"General"}),(0,a.jsx)("span",{className:"text-xs opacity-60",children:P.filter(e=>"all"===e.to||!e.to).length>0&&new Date(Math.max(...P.filter(e=>"all"===e.to||!e.to).map(e=>e.time||0))).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)("p",{className:"text-xs opacity-60 truncate",children:P.filter(e=>"all"===e.to||!e.to).length>0?P.filter(e=>"all"===e.to||!e.to).slice(-1)[0].text:"No messages yet"})]})]}),(0,a.jsx)("div",{className:"mt-6 mb-3",children:(0,a.jsx)("span",{className:"text-xs font-medium text-gray-400",children:"Online Users"})}),L.filter(e=>e!==G).map(e=>{let t=P.filter(t=>t.from===G&&t.to===e||t.from===e&&t.to===G).slice(-1)[0],s=Q.find(t=>t.name===e);return(0,a.jsxs)("div",{className:"flex items-center p-3 rounded-xl cursor-pointer mb-2 transition-all duration-200 ".concat(B===e?"bg-white text-black":"hover:bg-gray-800 text-white"),onClick:()=>J(e),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(y,{className:"w-12 h-12",children:"Admin"===e?(0,a.jsx)(j,{src:"/kamogelo-photo.jpg",alt:"Admin"}):(0,a.jsx)(N,{className:"".concat((null==s?void 0:s.color)||"bg-gray-500"," text-white font-semibold"),children:e.slice(0,2).toUpperCase()})}),(0,a.jsx)("div",{className:"absolute bottom-0 right-0 w-4 h-4 bg-green-500 border-2 border-black rounded-full"})]}),(0,a.jsxs)("div",{className:"ml-3 flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:e}),!ea.includes(e)&&"Admin"!==e&&(0,a.jsx)(w.C,{variant:"outline",className:"text-xs border-gray-400",children:"Request access"}),(0,a.jsx)("span",{className:"text-xs opacity-60",children:t&&new Date(t.time||0).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)("p",{className:"text-xs opacity-60 truncate",children:t?t.text:"Start a conversation"})]})]},e)})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsxs)("div",{className:"lg:hidden bg-black border-b border-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(y,{className:"w-10 h-10",children:(0,a.jsx)(N,{className:"".concat($," text-white font-semibold"),children:G.slice(0,2).toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-white",children:G}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"● Online"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(b.z,{size:"sm",variant:"ghost",className:"text-white hover:bg-gray-800",children:(0,a.jsx)(o.Z,{size:18})}),(0,a.jsx)(b.z,{size:"sm",variant:"ghost",className:"text-white hover:bg-gray-800",children:(0,a.jsx)(d.Z,{size:18})})]})]}),(0,a.jsx)("div",{className:"px-4 pb-4",children:(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Chats"})}),(0,a.jsxs)("div",{className:"px-4 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center p-3 rounded-xl cursor-pointer mb-3 ".concat("all"===B?"bg-white text-black":"hover:bg-gray-800 text-white"),onClick:()=>J("all"),children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{size:20,className:"text-white"})})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:"General"}),(0,a.jsx)("span",{className:"text-xs opacity-60",children:P.filter(e=>"all"===e.to||!e.to).length>0&&new Date(Math.max(...P.filter(e=>"all"===e.to||!e.to).map(e=>e.time||0))).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)("p",{className:"text-xs opacity-60",children:P.filter(e=>"all"===e.to||!e.to).length>0?P.filter(e=>"all"===e.to||!e.to).slice(-1)[0].text:"No messages yet"})]})]}),L.filter(e=>e!==G).map(e=>{let t=Q.find(t=>t.name===e),s=P.filter(t=>t.from===G&&t.to===e||t.from===e&&t.to===G).slice(-1)[0];return(0,a.jsxs)("div",{className:"flex items-center p-3 rounded-xl cursor-pointer mb-3 ".concat(B===e?"bg-white text-black":"hover:bg-gray-800 text-white"),onClick:()=>J(e),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(y,{className:"w-12 h-12",children:"Admin"===e?(0,a.jsx)(j,{src:"/kamogelo-photo.jpg",alt:"Admin"}):(0,a.jsx)(N,{className:"".concat((null==t?void 0:t.color)||"bg-gray-500"," text-white font-semibold"),children:e.slice(0,2).toUpperCase()})}),(0,a.jsx)("div",{className:"absolute bottom-0 right-0 w-4 h-4 bg-green-500 border-2 border-black rounded-full"})]}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:e}),!ea.includes(e)&&"Admin"!==e&&(0,a.jsx)(w.C,{variant:"outline",className:"text-xs border-gray-400",children:"Request"}),(0,a.jsx)("span",{className:"text-xs opacity-60",children:s&&new Date(s.time||0).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)("p",{className:"text-xs opacity-60",children:s?s.text:"Start a conversation"})]})]},e)}),(0,a.jsx)("div",{className:"mt-4 mb-3",children:(0,a.jsxs)("span",{className:"text-xs font-medium text-gray-400",children:["Online Users (",L.length,")"]})})]})]}),(0,a.jsx)("div",{className:"hidden lg:flex bg-black border-b border-gray-800 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:["all"===B?(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{size:20,className:"text-white"})}):(0,a.jsx)(y,{className:"w-10 h-10",children:"Admin"===B?(0,a.jsx)(j,{src:"/kamogelo-photo.jpg",alt:"Admin"}):(0,a.jsx)(N,{className:"".concat((null===(e=Q.find(e=>e.name===B))||void 0===e?void 0:e.color)||"bg-gray-500"," text-white font-semibold"),children:B.slice(0,2).toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"all"===B?"General":B}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"all"===B?"".concat(L.length+1," members"):"Active now"})]})]})}),p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-black rounded-lg shadow-xl p-6 w-full max-w-xs flex flex-col gap-4 border border-gray-800",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-center text-white",children:"Admin Login"}),(0,a.jsx)(f,{type:"password",placeholder:"Enter admin password",value:I,onChange:e=>T(e.target.value),className:"bg-gray-900 border-gray-700 text-white placeholder:text-gray-500",autoFocus:!0}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(b.z,{className:"flex-1 bg-white text-black hover:bg-gray-200",onClick:()=>{"2255"===I&&(s(!0),v(!1),H("Admin"),X("bg-purple-600"),z(!1))},children:"Login"}),(0,a.jsx)(b.z,{variant:"outline",className:"flex-1 border-gray-600 text-white hover:bg-gray-800",onClick:()=>v(!1),children:"Cancel"})]}),I&&"2255"!==I&&(0,a.jsx)("span",{className:"text-xs text-red-400 text-center",children:"Incorrect password"})]})}),S&&t&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-black rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] overflow-hidden border border-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-white",children:"User Phonebook"}),(0,a.jsx)(b.z,{variant:"ghost",size:"sm",onClick:()=>k(!1),className:"text-white hover:bg-gray-800",children:(0,a.jsx)(n.Z,{size:16})})]}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-[calc(80vh-120px)] p-4",children:0===eg.length?(0,a.jsx)("div",{className:"text-center text-gray-400 py-8",children:(0,a.jsx)("p",{children:"No registered users yet."})}):(0,a.jsx)("div",{className:"space-y-4",children:eg.map(e=>(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg text-white",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:e.company})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-white",children:"Email:"}),(0,a.jsx)("a",{href:"mailto:".concat(e.email),className:"text-gray-400 hover:underline",children:e.email})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-white",children:"Phone:"}),(0,a.jsx)("a",{href:"tel:".concat(e.phone),className:"text-gray-400 hover:underline",children:e.phone})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-white",children:"Joined:"}),(0,a.jsx)("span",{className:"text-gray-400",children:new Date(e.joinedAt).toLocaleDateString()})]})]})]})},e.id))})}),(0,a.jsx)("div",{className:"border-t border-gray-800 p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[(0,a.jsxs)("span",{children:["Total registered users: ",eg.length]}),(0,a.jsx)(b.z,{variant:"outline",onClick:()=>k(!1),className:"border-gray-600 text-white hover:bg-gray-800",children:"Close"})]})})]})}),(0,a.jsxs)("div",{className:"hidden lg:flex lg:flex-col lg:flex-1 lg:min-h-0 bg-black",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 chat-messages",style:{overscrollBehavior:"contain"},children:[P.filter(e=>"all"===B?"all"===e.to||!e.to:e.from===G&&e.to===B||e.from===B&&e.to===G).map(e=>{let t=Q.find(t=>t.name===e.from);return(0,a.jsxs)("div",{className:"flex items-start space-x-4 message-enter",children:[(0,a.jsx)(y,{className:"w-10 h-10 flex-shrink-0",children:"Admin"===e.from?(0,a.jsx)(j,{src:"/kamogelo-photo.jpg",alt:"Admin"}):(0,a.jsx)(N,{className:"".concat(e.from===G?$:(null==t?void 0:t.color)||"bg-gray-500"," text-white font-semibold"),children:(e.from===G?"You":e.from).slice(0,2).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-white",children:e.from===G?"You":e.from}),"Admin"===e.from&&(0,a.jsx)(w.C,{variant:"secondary",className:"text-xs bg-gray-800 text-white border-gray-700",children:"Admin"}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:e.time?new Date(e.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-2xl px-4 py-3 border border-gray-700 max-w-2xl",children:(0,a.jsx)("p",{className:"text-sm text-white leading-relaxed break-words",children:e.text})})]})]},e.id)}),(0,a.jsx)("div",{ref:K})]}),(0,a.jsx)("div",{className:"border-t border-gray-800 bg-black p-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),eN()},className:"flex items-end space-x-4",children:[(0,a.jsx)(b.z,{type:"button",size:"sm",variant:"ghost",className:"h-10 w-10 p-0 rounded-full hover:bg-gray-600 mr-2 flex-shrink-0",onClick:ek,disabled:ew||!_.trim(),"aria-label":"Gemini Audio Reply",children:ew?(0,a.jsx)("span",{className:"animate-spin",children:"\uD83D\uDD0A"}):(0,a.jsx)("span",{children:"\uD83D\uDD0A"})}),t&&(0,a.jsx)(y,{className:"w-10 h-10 flex-shrink-0",children:(0,a.jsx)(j,{src:"/kamogelo-photo.jpg",alt:"Admin"})}),(0,a.jsx)("div",{className:"flex-1 relative",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-2xl border border-gray-700 p-4",children:[(0,a.jsx)(f,{type:"text",value:_,onChange:e=>q(e.target.value),placeholder:"Message ".concat("all"===B?"General":B,"..."),className:"border-0 bg-transparent p-0 text-base placeholder:text-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 text-white",style:{fontSize:16}}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(b.z,{type:"button",size:"sm",variant:"ghost",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-600",children:(0,a.jsx)(m.Z,{size:16,className:"text-gray-400"})}),(0,a.jsx)(b.z,{type:"button",size:"sm",variant:"ghost",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-600",children:(0,a.jsx)(h.Z,{size:16,className:"text-gray-400"})})]}),(0,a.jsx)(b.z,{type:"submit",disabled:!_.trim(),size:"sm",className:"h-9 px-4 rounded-full bg-white hover:bg-gray-200 disabled:opacity-50 text-black font-medium",children:"Send"})]})]})})]})})]}),(0,a.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-black border-t border-gray-800 px-4 py-2 safe-area-pb",children:(0,a.jsxs)("div",{className:"flex items-center justify-around",children:[(0,a.jsxs)(b.z,{variant:"ghost",size:"sm",className:"flex flex-col items-center space-y-1 h-auto py-2",children:[(0,a.jsx)(x.Z,{size:20,className:"text-white"}),(0,a.jsx)("span",{className:"text-xs text-white font-medium",children:"Chats"})]}),(0,a.jsxs)(b.z,{variant:"ghost",size:"sm",className:"flex flex-col items-center space-y-1 h-auto py-2",children:[(0,a.jsx)(u.Z,{size:20,className:"text-gray-400"}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"People"})]}),(0,a.jsxs)(b.z,{variant:"ghost",size:"sm",className:"flex flex-col items-center space-y-1 h-auto py-2",children:[(0,a.jsx)(l.Z,{size:20,className:"text-gray-400"}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Calls"})]}),(0,a.jsxs)(b.z,{variant:"ghost",size:"sm",className:"flex flex-col items-center space-y-1 h-auto py-2",children:[(0,a.jsx)(g.Z,{size:20,className:"text-gray-400"}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Settings"})]})]})})]}),G&&!C&&(0,a.jsx)(A,{onTranscript:e=>{W.current&&G&&!W.current.sendMessage(B,"\uD83C\uDFA4 ".concat(e))&&console.log("Voice message requires permission or failed to send")}}),el&&en&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-black rounded-lg shadow-xl w-full max-w-md border border-gray-800",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Message Request"}),(0,a.jsxs)("p",{className:"text-sm text-gray-400 mb-4",children:[(0,a.jsx)("span",{className:"font-medium text-white",children:en.from})," wants to send you a message:"]}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-3 mb-6 border border-gray-700",children:(0,a.jsxs)("p",{className:"text-sm text-white break-words",children:['"',en.message,'"']})}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(b.z,{onClick:()=>eC(!1),variant:"outline",className:"flex-1 border-gray-600 text-white hover:bg-gray-800",children:"Decline"}),(0,a.jsx)(b.z,{onClick:()=>eC(!0),className:"flex-1 bg-white text-black hover:bg-gray-200",children:"Accept"})]})]})})})]})}},116:function(e,t,s){"use strict";s.d(t,{C:function(){return n}});var a=s(5434);s(3936);var r=s(6638),l=s(2533);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)(i({variant:s}),t),...r})}},5258:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var a=s(5434),r=s(3936),l=s(1965),i=s(6638),n=s(2533);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:c=!1,...d}=e,m=c?l.g7:"button";return(0,a.jsx)(m,{className:(0,n.cn)(o({variant:r,size:i,className:s})),ref:t,...d})});c.displayName="Button"},2644:function(e,t,s){"use strict";s.d(t,{pm:function(){return h}});var a=s(3936);let r=0,l=new Map,i=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=n(c,e),o.forEach(e=>{e(c)})}function m(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function h(){let[e,t]=a.useState(c);return a.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},8838:function(e,t){"use strict";class s{loadFromStorage(){try{let e=localStorage.getItem(this.storageKey);if(e){let t=JSON.parse(e);this.messageHistory=t.messageHistory||[],this.allowedContacts=new Set(t.allowedContacts||[])}}catch(e){console.error("Error loading from storage:",e)}}saveToStorage(){try{let e={messageHistory:this.messageHistory,allowedContacts:Array.from(this.allowedContacts)};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(e){console.error("Error saving to storage:",e)}}join(e,t,s,a){return this.localUser={name:e,color:t,email:s,phone:a},this.users.set(e,{name:e,color:t,email:s,phone:a,online:!0,lastSeen:Date.now()}),this.broadcast({type:"user-joined",user:this.localUser,timestamp:Date.now()}),this.allowedContacts.add("Admin"),console.log("".concat(e," joined peer chat system")),this.getOnlineUsers()}getOnlineUsers(){let e=Date.now(),t=[];for(let[s,a]of this.users.entries())e-a.lastSeen<3e4&&t.push({name:a.name,color:a.color,email:a.email,phone:a.phone});return t.find(e=>"Admin"===e.name)||t.push({name:"Admin",color:"bg-purple-600",email:"admin@kamogelomosia.com",phone:"+27 123 456 789"}),t}sendMessage(e,t){if(!this.localUser)return!1;let s={id:Date.now()+Math.random(),from:this.localUser.name,to:e,text:t,time:Date.now(),type:"message"};return"all"===e||"Admin"===e||this.allowedContacts.has(e)?(this.messageHistory.push(s),this.saveToStorage(),this.broadcast({type:"new-message",message:s}),!0):(this.requestPermission(e,t),!1)}requestPermission(e,t){let s="req_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));this.broadcast({type:"permission-request",from:this.localUser.name,to:e,message:t,requestId:s}),console.log("Permission request sent to ".concat(e))}handlePermissionResponse(e,t,s){t&&(this.allowedContacts.add(e),this.saveToStorage()),this.broadcast({type:"permission-response",from:this.localUser.name,to:e,granted:t,requestId:s})}handleBroadcastMessage(e){var t,s,a,r,l,i,n,o,c,d,m;let h=e.data;switch(h.type){case"user-joined":this.users.set(h.user.name,{...h.user,online:!0,lastSeen:h.timestamp}),null===(t=this.onUsersUpdate)||void 0===t||t.call(this,this.getOnlineUsers());break;case"new-message":if("all"===h.message.to||h.message.to===(null===(s=this.localUser)||void 0===s?void 0:s.name)||h.message.from===(null===(a=this.localUser)||void 0===a?void 0:a.name)){if(h.message.to===(null===(r=this.localUser)||void 0===r?void 0:r.name)&&"Admin"!==h.message.from&&!this.allowedContacts.has(h.message.from)){null===(i=this.onPermissionRequest)||void 0===i||i.call(this,h.message.from,h.message.text);return}this.messageHistory.push(h.message),this.saveToStorage(),null===(l=this.onNewMessage)||void 0===l||l.call(this,h.message)}break;case"permission-request":h.to===(null===(n=this.localUser)||void 0===n?void 0:n.name)&&(null===(o=this.onPermissionRequest)||void 0===o||o.call(this,h.from,h.message,h.requestId));break;case"permission-response":h.to===(null===(c=this.localUser)||void 0===c?void 0:c.name)&&h.granted&&(this.allowedContacts.add(h.from),this.saveToStorage(),null===(d=this.onPermissionGranted)||void 0===d||d.call(this,h.from));break;case"heartbeat":h.user!==(null===(m=this.localUser)||void 0===m?void 0:m.name)&&this.users.set(h.user,{...this.users.get(h.user),lastSeen:h.timestamp})}}broadcast(e){try{this.channel.postMessage(e)}catch(e){console.error("Error broadcasting message:",e)}}getMessages(){return this.messageHistory}startHeartbeat(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=setInterval(()=>{this.localUser&&this.broadcast({type:"heartbeat",user:this.localUser.name,timestamp:Date.now()})},1e4)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}leave(){this.stopHeartbeat(),this.localUser&&this.broadcast({type:"user-left",user:this.localUser.name,timestamp:Date.now()}),this.localUser=null}constructor(){this.onNewMessage=null,this.onUsersUpdate=null,this.onPermissionRequest=null,this.onPermissionGranted=null,this.users=new Map,this.connections=new Map,this.localUser=null,this.messageHistory=[],this.allowedContacts=new Set,this.pendingRequests=new Map,this.storageKey="peer-chat-data",this.loadFromStorage(),this.channel=new BroadcastChannel("peer-chat-channel"),this.channel.onmessage=this.handleBroadcastMessage.bind(this)}}window.PeerChatSystem=s,t.Z=s},2533:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var a=s(91),r=s(9827);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[989,491,651,480,744],function(){return e(e.s=6330)}),_N_E=e.O()}]);